<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Webcam + multiple AR overlays</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  :root{--overlay-w:320px;}                     /* default overlay size */

  html,body{margin:0;height:100%;overflow:hidden;font-family:sans-serif}
  #stage{position:relative;width:100%;height:100%;background:#000;overflow:hidden}

  /*  ðŸ”´ Live camera layer  */
  #cam{width:100%;height:100%;object-fit:cover}

  /*  ðŸ”´ Every overlay video gets this class  */
  .overlay{
    position:absolute;top:50%;left:50%;
    width:var(--overlay-w);transform:translate(-50%,-50%);
    pointer-events:none;                        /* clicks pass through cam */
    mix-blend-mode:screen;                      /* lighten-blend for glow */
  }

  /*  ðŸ”´ Control panel  */
  #controls{
    position:absolute;bottom:12px;left:50%;transform:translateX(-50%);
    background:rgba(0,0,0,.6);color:#fff;padding:8px 14px;border-radius:12px;
    display:flex;gap:10px;align-items:center;font-size:14px
  }
  #controls label{cursor:pointer}
  #effects>button{margin:0 2px;padding:4px 8px;border:1px solid #888;background:#222;color:#fff;border-radius:6px;cursor:pointer}
  #effects>button.active{background:#4caf50}
</style>
</head>
<body>

<div id="stage">
  <video id="cam" playsinline autoplay muted></video>
</div>

<div id="controls">
  <label>+ Add overlay
    <input type="file" id="filePicker" accept="video/mp4,video/webm" hidden>
  </label>
  <div id="effects">
    <!-- built-in demo clips (replace with your own URLs) -->
    <button data-src="/video/123.mp4">123</button>
    <button data-src="/video/456.mp4">456</button>
    <button data-src="/video/123.mp4">123</button>
  </div>
</div>

<script>
/* 1ï¸âƒ£  Boot the camera */
(async () => {
  try{
    const stream = await navigator.mediaDevices.getUserMedia({video:true});
    document.getElementById('cam').srcObject = stream;
  }catch(e){
    alert('Unable to access webcam: '+e.message);
  }
})();

/* 2ï¸âƒ£  Helper: spawn an overlay video element */
function createOverlay(src){
  const vid = document.createElement('video');
  vid.src = src;
  vid.loop = true;
  vid.muted = true;
  vid.playsInline = true;
  vid.autoplay = true;
  vid.className = 'overlay';
  /* simple drag-to-move */
  let ox=0, oy=0;
  vid.addEventListener('pointerdown', e=>{
    ox = e.offsetX; oy = e.offsetY;
    const move = m=>{
      vid.style.left = m.pageX - ox +'px';
      vid.style.top  = m.pageY - oy +'px';
    };
    document.addEventListener('pointermove', move);
    document.addEventListener('pointerup', ()=>document.removeEventListener('pointermove', move), {once:true});
  });
  document.getElementById('stage').appendChild(vid);
}

/* 3ï¸âƒ£  Local file picker */
document.getElementById('filePicker').addEventListener('change', e=>{
  const file = e.target.files[0];
  if(file) createOverlay(URL.createObjectURL(file));
  e.target.value='';                             // reset so same file can be re-selected
});

/* 4ï¸âƒ£  Built-in effects toggles */
document.querySelectorAll('#effects button').forEach(btn=>{
  let added = false, overlayEl;
  btn.addEventListener('click', () => {
    if(!added){                                   // add
      overlayEl = createOverlay(btn.dataset.src);
      btn.classList.add('active');
      added = true;
    }else{                                        // remove
      overlayEl.remove();
      btn.classList.remove('active');
      added = false;
    }
  });
});
</script>

</body>
</html>
